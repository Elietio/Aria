<ui:FluentWindow x:Class="ScreenBridge.App.WindowOverview"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:local="clr-namespace:ScreenBridge.App"
        mc:Ignorable="d"
        Title="çª—å£æ¦‚è§ˆ" 
        Height="600" Width="1000"
        WindowStartupLocation="CenterScreen"
        ExtendsContentIntoTitleBar="True"
        Topmost="True"

        KeyDown="Window_KeyDown">

    <ui:FluentWindow.Resources>
        <SolidColorBrush x:Key="CardBackgroundBrush" Color="#20808080"/>
        <Style TargetType="ui:Card">
            <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CardBorderBrush}"/>
        </Style>
    </ui:FluentWindow.Resources>

    <Grid Margin="16" MouseLeftButtonDown="Window_MouseLeftButtonDown" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Layer 0: Ambient Glow (Radial Only) -->
        <Border x:Name="AmbientGlow" Grid.RowSpan="2" Opacity="0.6" Visibility="Collapsed">
            <Border.Background>
                <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.8" RadiusY="0.8">
                    <GradientStop x:Name="AmbientGlowInner" Color="#00BFFF" Offset="0"/>
                    <GradientStop Color="Transparent" Offset="1"/>
                </RadialGradientBrush>
            </Border.Background>
        </Border>

        <!-- Layer 1: Mascot (Spans All Rows, Bottom Right for Overview) -->
        <Image x:Name="MascotImage" Grid.RowSpan="2" 
               HorizontalAlignment="Right" VerticalAlignment="Bottom" 
               Height="500" Stretch="Uniform" Opacity="0.10" Margin="0,0,-50,-20"
               RenderOptions.BitmapScalingMode="HighQuality"
               Visibility="Collapsed"
               IsHitTestVisible="False"/>

        <!-- æ ‡é¢˜ -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
            <TextBlock Text="çª—å£æ¦‚è§ˆ" FontSize="24" FontWeight="SemiBold" VerticalAlignment="Center"/>
            <TextBlock Text=" - ç‚¹å‡»çª—å£ä»¥æ¿€æ´»ï¼ŒæŒ‰ä½æ‹–åŠ¨æˆ–ç‚¹å‡»ç®­å¤´å¯ç§»åŠ¨åˆ°å¦ä¸€æ˜¾ç¤ºå™¨" 
                       Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}" 
                       FontSize="14" VerticalAlignment="Center" Margin="8,0,0,0"/>
            <TextBlock Text="ï¼ˆæŒ‰ ESC å…³é—­ï¼‰" 
                       Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}" 
                       FontSize="12" VerticalAlignment="Center" Margin="8,0,0,0"/>
        </StackPanel>

        <!-- æ˜¾ç¤ºå™¨åŒºåŸŸ -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- å·¦æ˜¾ç¤ºå™¨ -->
            <ui:Card Grid.Column="0" Margin="0,0,8,0" 
                     AllowDrop="True" Drop="LeftMonitor_Drop">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock x:Name="LeftMonitorHeader" Grid.Row="0" Text="ðŸ–¥ï¸ å·¦æ˜¾ç¤ºå™¨" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="LeftMonitorList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <ui:Card Margin="0,0,0,8" Padding="12" 
                                             PreviewMouseLeftButtonDown="WindowCard_PreviewMouseLeftButtonDown"
                                             PreviewMouseMove="WindowCard_PreviewMouseMove"
                                             PreviewMouseLeftButtonUp="WindowCard_PreviewMouseLeftButtonUp"
                                             Cursor="Hand">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Grid.Column="0" Width="48" Height="36" 
                                                    Background="Transparent"
                                                    Margin="0,0,12,0">
                                                <Image Source="{Binding Icon}" Width="24" Height="24" RenderOptions.BitmapScalingMode="HighQuality"/>
                                            </Border>
                                            <TextBlock Grid.Column="1" Text="{Binding Title}" 
                                                       TextTrimming="CharacterEllipsis"
                                                       VerticalAlignment="Center"/>
                                            <ui:Button Grid.Column="2" 
                                                       Appearance="Secondary" Margin="8,0,0,0" Padding="8,4"
                                                       Click="MoveToRight_Click"
                                                       ToolTip="å‘é€åˆ°å³ä¾§æ˜¾ç¤ºå™¨">
                                                <Viewbox Width="20" Height="20">
                                                    <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=ui:Button}, Path=Foreground}" 
                                                          Data="M4,4 H20 V20 H4 Z M5,5 V19 H19 V5 Z M8,11 H13 V9 L16,12 L13,15 V13 H8 Z"/>
                                                </Viewbox>
                                            </ui:Button>
                                        </Grid>
                                    </ui:Card>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </ui:Card>

            <!-- å³æ˜¾ç¤ºå™¨ -->
            <ui:Card Grid.Column="1" Margin="8,0,0,0"
                     AllowDrop="True" Drop="RightMonitor_Drop">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock x:Name="RightMonitorHeader" Grid.Row="0" Text="ðŸ–¥ï¸ å³æ˜¾ç¤ºå™¨" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="RightMonitorList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <ui:Card Margin="0,0,0,8" Padding="12"
                                             PreviewMouseLeftButtonDown="WindowCard_PreviewMouseLeftButtonDown"
                                             PreviewMouseMove="WindowCard_PreviewMouseMove"
                                             PreviewMouseLeftButtonUp="WindowCard_PreviewMouseLeftButtonUp"
                                             Cursor="Hand">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Grid.Column="0" Width="48" Height="36" 
                                                    Background="Transparent"
                                                    Margin="0,0,12,0">
                                                <Image Source="{Binding Icon}" Width="24" Height="24" RenderOptions.BitmapScalingMode="HighQuality"/>
                                            </Border>
                                            <TextBlock Grid.Column="1" Text="{Binding Title}" 
                                                       TextTrimming="CharacterEllipsis"
                                                       VerticalAlignment="Center"/>
                                            <ui:Button Grid.Column="2" 
                                                       Appearance="Secondary" Margin="8,0,0,0" Padding="8,4"
                                                       Click="MoveToLeft_Click"
                                                       ToolTip="å‘é€åˆ°å·¦ä¾§æ˜¾ç¤ºå™¨">
                                                <Viewbox Width="20" Height="20">
                                                    <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=ui:Button}, Path=Foreground}" 
                                                          Data="M4,4 H20 V20 H4 Z M5,5 V19 H19 V5 Z M16,11 H11 V9 L8,12 L11,15 V13 H16 Z"/>
                                                </Viewbox>
                                            </ui:Button>
                                        </Grid>
                                    </ui:Card>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </ui:Card>
        </Grid>
    </Grid>
</ui:FluentWindow>
